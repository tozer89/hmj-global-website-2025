<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Candidates — Admin | HMJ Global</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  <link rel="stylesheet" href="/css/admin.css" />
  <script>window.ADMIN_IDENTITY_URL = 'https://hmjg.netlify.app/.netlify/identity';</script>
  <script defer src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script defer src="/admin/common.js?v=21"></script>
  <style>
    /* Minimal layout scaffolding; move to css/admin.css if preferred */
    :root { --bg:#0b1020; --card:#121a33; --muted:#8fa3c7; --text:#e9eefc; --accent:#3a66b3; --warn:#e8a600; --ok:#24b36b; --err:#de3d5a; }
    html,body{height:100%;background:var(--bg);color:var(--text);font:14px/1.4 system-ui,Segoe UI,Roboto,Arial,sans-serif;}
    .wrap{display:grid;grid-template-columns:280px 1fr;gap:16px;padding:16px;max-width:1400px;margin:0 auto;}
    header{display:flex;align-items:center;gap:8px;justify-content:space-between;padding:12px 16px;background:var(--card);border-radius:12px;margin:16px auto;max-width:1400px}
    header .crumbs{opacity:.9}
    .pill{padding:4px 8px;border-radius:999px;background:#1b254a;color:#cfe0ff;border:1px solid #263263;}
    .ok{background:rgba(36,179,107,.12);color:#8ef0c1;border-color:rgba(36,179,107,.4)}
    .warn{background:rgba(232,166,0,.12);color:#ffd27a;border-color:rgba(232,166,0,.4)}
    .err{background:rgba(222,61,90,.12);color:#ffb1bf;border-color:rgba(222,61,90,.4)}
    .card{background:var(--card);border:1px solid #1f2a52;border-radius:12px}
    .sidebar{display:flex;flex-direction:column;gap:12px;padding:12px}
    .sidebar h3{margin:8px 0 4px 0;font-size:13px;color:#cfe0ff}
    .sidebar input,.sidebar select,.sidebar textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #2a3766;background:#0e1530;color:var(--text)}
    .sidebar .group{display:grid;gap:8px}
    .grid{display:grid;gap:16px}
    .toolbar{display:flex;align-items:center;gap:8px;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #24305c}
    .search{display:flex;gap:8px;flex:1}
    .search input{flex:1}
    .totals{display:flex;gap:8px;flex-wrap:wrap}
    .table{display:flex;flex-direction:column;height:62vh}
    .thead,.trow{display:grid;grid-template-columns:32px 120px 1fr 1fr 140px 180px 120px;gap:8px;align-items:center;padding:10px 12px;border-bottom:1px solid #222f5a}
    .thead{position:sticky;top:0;background:linear-gradient(#121a33,#101734)}
    .trow:hover{background:#0f1732}
    .vscroll{overflow:auto;flex:1}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border-radius:999px;border:1px solid #2b3a6e;background:#0e1736;font-size:12px}
    .chip.green{border-color:rgba(36,179,107,.4);color:#8ef0c1}
    .chip.orange{border-color:rgba(232,166,0,.4);color:#ffd27a}
    .chip.blue{border-color:#3a66b3;color:#a9c3ff}
    .chip.gray{border-color:#3b476f;color:#b7c7ea;opacity:.8}
    .chip.red{border-color:rgba(222,61,90,.4);color:#ffb1bf}
    .fab{position:fixed;right:24px;bottom:24px;background:var(--accent);color:white;border:none;border-radius:12px;padding:12px 16px;box-shadow:0 8px 24px rgba(0,0,0,.35);cursor:pointer}
    .drawer{position:fixed;top:0;right:-520px;width:520px;height:100%;background:var(--card);border-left:1px solid #223064;transition:right .25s ease;overflow:auto}
    .drawer.open{right:0}
    .drawer .head{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #223064}
    .drawer .sec{padding:16px;border-bottom:1px solid #1a274f}
    .bulkbar{position:sticky;bottom:0;background:#0f1630;border-top:1px solid #203064;padding:8px 12px;display:none;gap:8px;align-items:center;justify-content:space-between}
    .bulkbar.show{display:flex}
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:20px;background:#0f1734;border:1px solid #27408b;padding:10px 14px;border-radius:10px;display:none}
    .toast.show{display:block}
    .debug{position:fixed;top:8px;right:8px;display:flex;gap:6px}
    .btn{border:1px solid #2b3b73;background:#0f1836;color:#cfe0ff;padding:8px 10px;border-radius:8px;cursor:pointer}
    .btn.primary{background:var(--accent);border-color:#355fb0;color:white}
    .btn.red{background:#3a0e1a;border-color:#7a1f3b;color:#ffbfd0}
    .btn.ghost{background:transparent}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <header class="card">
    <div class="crumbs">Admin → Candidates</div>
    <div class="debug">
      <span class="pill ok" id="dbg-identity">identity: ok</span>
      <span class="pill ok" id="dbg-token">token: ok</span>
      <span class="pill ok" id="dbg-role">role: admin</span>
      <span class="pill" id="dbg-sb">supabase: live</span>
      <span class="pill" id="dbg-version">build: -</span>
    </div>
  </header>

  <div class="wrap">
    <!-- Filters -->
    <aside class="card sidebar" id="filters">
      <div class="group">
        <h3>Search</h3>
        <input id="q" placeholder='name, email, ref… (supports AND/OR/NOT)' />
      </div>
      <div class="group">
        <h3>Status</h3>
        <select id="flt-status" multiple>
          <option>active</option><option>in progress</option><option>complete</option>
          <option>archived</option><option>blocked</option>
        </select>
      </div>
      <div class="group">
        <h3>Role &amp; region</h3>
        <input id="flt-role" placeholder="role title" />
        <input id="flt-region" placeholder="country / region / depot" />
      </div>
      <div class="group">
        <h3>Skills / tags</h3>
        <input id="flt-skills" placeholder="comma separated e.g. SAP, LV, MV" />
      </div>
      <div class="group">
        <h3>Availability</h3>
        <input id="flt-avail" type="date" />
      </div>
      <div class="group">
        <h3>Dates</h3>
        <input id="flt-created-from" type="date" />
        <input id="flt-created-to" type="date" />
      </div>
      <div class="group" style="display:flex;gap:8px">
        <button class="btn" id="btn-clear">Clear all</button>
        <button class="btn primary" id="btn-apply">Apply</button>
      </div>
      <div class="muted" id="flt-count">0 results</div>
    </aside>

    <!-- Main -->
    <main class="grid">
      <section class="card">
        <div class="toolbar">
          <div class="search">
            <input id="search" placeholder="Quick search ( / to focus )" />
            <button class="btn" id="btn-refresh">Refresh</button>
          </div>
          <div class="totals">
            <span class="pill" id="t-total">Total: 0</span>
            <span class="pill" id="t-progress">In progress: 0</span>
            <span class="pill" id="t-archived">Archived: 0</span>
            <span class="pill" id="t-blocked">Blocked: 0</span>
          </div>
        </div>

        <div class="table">
          <div class="thead">
            <div><input type="checkbox" id="chk-all"/></div>
            <div>Ref</div><div>Name</div><div>Email</div><div>Status</div><div>Job Title</div><div>Actions</div>
          </div>
          <div class="vscroll" id="rows" aria-live="polite"></div>
          <div class="bulkbar" id="bulkbar">
            <div id="bulk-count">0 selected</div>
            <div style="display:flex;gap:8px">
              <button class="btn" id="bulk-assign">Assign recruiter</button>
              <button class="btn" id="bulk-status">Update status</button>
              <button class="btn red" id="bulk-block">Block</button>
              <button class="btn" id="bulk-archive">Archive</button>
              <button class="btn" id="bulk-export">Export CSV</button>
              <button class="btn ghost" id="bulk-clear">Clear</button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Drawer -->
  <aside class="drawer" id="drawer">
    <div class="head">
      <strong id="dw-name">Candidate</strong>
      <div style="display:flex;gap:8px">
        <button class="btn" id="dw-email">Email</button>
        <button class="btn" id="dw-call">Call</button>
        <button class="btn red" id="dw-block">Block</button>
        <button class="btn ghost" id="dw-close">Close</button>
      </div>
    </div>
    <div class="sec" id="dw-profile"></div>
    <div class="sec" id="dw-docs"></div>
    <div class="sec" id="dw-notes"></div>
    <div class="sec" id="dw-audit"></div>
  </aside>

  <button class="fab" id="fab-new">+ New candidate</button>
  <div class="toast" id="toast"></div>

  <script defer src="/admin/candidates.js"></script>
</body>
</html>
