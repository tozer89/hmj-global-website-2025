<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Candidates — Admin | HMJ Global</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  <link rel="stylesheet" href="/css/admin.css" />
  <script>
    window.ADMIN_IDENTITY_URL = 'https://hmjg.netlify.app/.netlify/identity';
  </script>
  <script defer src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script defer src="/admin/common.js?v=21"></script>
  <style>
    :root {
      --ink:#0f172a; --muted:#64748b; --bg:#f4f7fb;
      --blue:#2f4ea2; --blue-2:#27408f;
      --card:#ffffff; --stroke:#e2e8f0; --ring:#c7d2fe; --chip:#eef2ff;
      --ok:#16a34a; --warn:#f59e0b; --bad:#dc2626;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 "Inter",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:inherit;text-decoration:none}

    .top{position:sticky;top:0;z-index:90;background:var(--blue);color:#fff;border-bottom:1px solid rgba(255,255,255,.2);box-shadow:0 14px 34px rgba(15,23,42,.26)}
    .row{max-width:1400px;margin:0 auto;padding:12px 16px;display:flex;gap:12px;align-items:center}
    .brand{font-weight:800;letter-spacing:.02em;display:flex;gap:10px;align-items:center}
    .brand a{display:inline-flex;gap:10px;align-items:center;color:#fff}
    .logo{width:28px;height:28px;border-radius:8px;background:#fff;display:grid;place-items:center;color:var(--blue);font-weight:900}
    .sp{flex:1}

    .pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:var(--chip);border:1px solid var(--stroke);font-size:12px;font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:var(--blue)}
    .top .pill{background:rgba(255,255,255,.18);border-color:rgba(255,255,255,.3);color:#fff}
    .pill.ok{background:#ecfdf5;border-color:#bbf7d0;color:#166534}
    .pill.warn{background:#fffbeb;border-color:#fde68a;color:#92400e}
    .pill.err,.pill.bad{background:#fef2f2;border-color:#fecaca;color:#991b1b}

    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;background:var(--blue);color:#fff;border:1px solid var(--blue);padding:9px 14px;border-radius:12px;font-weight:700;cursor:pointer;transition:transform .16s ease,box-shadow .2s ease,background .2s ease,border-color .2s ease;text-decoration:none}
    .btn:hover{transform:translateY(-1px);box-shadow:0 18px 34px rgba(47,78,162,.26);background:var(--blue-2);border-color:var(--blue-2)}
    .btn:disabled{cursor:not-allowed;opacity:.58;box-shadow:none;transform:none}
    .btn.small{padding:7px 11px;border-radius:10px;font-size:13px}
    .btn.ghost{background:#fff;color:var(--blue);border-color:rgba(47,78,162,.28)}
    .btn.ghost:hover{background:#f8fafc}
    .btn.light{background:#fff;color:var(--blue);border-color:#fff}
    .btn.red{background:#7a1f28;border-color:#7a1f28;color:#fff}
    .btn.primary{background:var(--blue);border-color:var(--blue);color:#fff}

    :focus{outline:3px solid var(--ring);outline-offset:2px;border-radius:8px}

    header.card.intro{max-width:1400px;margin:24px auto 0;padding:22px;background:var(--card);border:1px solid var(--stroke);border-radius:20px;display:flex;flex-wrap:wrap;gap:18px;align-items:flex-start;justify-content:space-between;box-shadow:0 18px 40px rgba(15,23,42,.08)}
    header.card.intro .crumbs{margin:0;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);font-weight:800}
    header.card.intro h1{margin:6px 0 8px;font-size:28px;line-height:1.15;color:var(--ink)}
    header.card.intro .lead{margin:0;color:var(--muted);max-width:720px}
    header.card.intro .debug{position:relative;display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    #debug-panel{position:relative}
    #debug-panel #debug-toggle{font-size:13px}
    #debug-panel .dbg-body{display:none;position:absolute;top:calc(100% + 10px);right:0;background:#fff;border:1px solid var(--stroke);border-radius:14px;padding:16px;box-shadow:0 18px 40px rgba(15,23,42,.16);min-width:260px;z-index:20}
    #debug-panel.open .dbg-body{display:grid;gap:10px}
    #debug-panel .dbg-row{display:flex;align-items:center;justify-content:space-between;font-size:13px;color:var(--muted)}
    #debug-panel .dbg-logs{margin:0;padding-left:18px;display:grid;gap:6px;max-height:180px;overflow:auto;font-size:12px;color:var(--muted)}

    .wrap{max-width:1400px;margin:24px auto;padding:0 16px 40px}
    .wrap.layout{display:grid;grid-template-columns:minmax(260px,320px) 1fr;gap:18px;align-items:start}
    .wrap.gate{display:flex;justify-content:center}

    .card{background:var(--card);border:1px solid var(--stroke);border-radius:18px;box-shadow:0 18px 36px rgba(15,23,42,.08)}
    .table-card{display:flex;flex-direction:column;overflow:hidden}
    .sidebar{display:grid;gap:16px;padding:18px;position:sticky;top:140px}
    .sidebar h3{margin:0;font-size:13px;font-weight:800;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
    .sidebar input,.sidebar select,.sidebar textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--stroke);background:#fff;color:var(--ink);font:inherit;font-weight:600;box-shadow:inset 0 1px 0 rgba(255,255,255,.6)}
    .sidebar select{appearance:auto}
    .sidebar select[multiple]{min-height:120px}
    .sidebar .group{display:grid;gap:10px}
    #flt-count{font-size:13px;color:var(--muted)}

    .grid{display:grid;gap:18px}

    .toolbar{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--stroke)}
    .search{display:flex;gap:10px;flex:1;align-items:center;min-width:260px}
    .search input{flex:1;padding:10px 12px;border-radius:12px;border:1px solid var(--stroke);background:#fff;font:inherit;font-weight:600;box-shadow:inset 0 1px 0 rgba(255,255,255,.6)}
    .totals{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    .table{display:flex;flex-direction:column;min-height:520px}
    .thead,.trow{display:grid;grid-template-columns:32px 120px 1fr 1fr 140px 180px 140px;gap:8px;align-items:center;padding:12px 16px;border-bottom:1px solid var(--stroke)}
    .thead{position:sticky;top:0;background:#fbfdff;font-size:13px;font-weight:800;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;z-index:1}
    .trow{font-size:15px}
    .trow:hover{background:#f8fafc}
    .vscroll{position:relative;overflow:auto;flex:1;background:#fff}

    .chip{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;border:1px solid var(--stroke);background:var(--chip);font-size:12px;font-weight:700;color:var(--blue)}
    .chip.green{background:#ecfdf5;border-color:#bbf7d0;color:#166534}
    .chip.orange{background:#fffbeb;border-color:#fde68a;color:#92400e}
    .chip.blue{background:#eff6ff;border-color:#bfdbfe;color:#1d4ed8}
    .chip.gray{background:#f1f5f9;border-color:#cbd5f5;color:#475569}
    .chip.red{background:#fef2f2;border-color:#fecaca;color:#b91c1c}

    .trow.skeleton{opacity:.55;pointer-events:none}

    .bulkbar{position:sticky;bottom:0;background:#f8faff;border-top:1px solid var(--stroke);padding:10px 16px;display:none;gap:12px;align-items:center;justify-content:space-between}
    .bulkbar.show{display:flex}
    .bulkbar > div:first-child{font-weight:700}

    .fab{position:fixed;right:24px;bottom:24px;background:var(--blue);color:#fff;border:none;border-radius:14px;padding:14px 18px;box-shadow:0 20px 44px rgba(15,23,42,.25);font-weight:800;cursor:pointer}
    .fab:hover{background:var(--blue-2)}

    .drawer{position:fixed;top:0;right:0;bottom:0;width:min(520px,92vw);background:#fff;border-left:1px solid var(--stroke);box-shadow:-24px 0 60px rgba(15,23,42,.18);transform:translateX(100%);transition:transform .24s ease;overflow:auto;z-index:120}
    .drawer.open{transform:translateX(0)}
    .drawer .head{display:flex;justify-content:space-between;align-items:center;padding:18px 20px;border-bottom:1px solid var(--stroke);background:var(--card)}
    .drawer .sec{padding:20px;border-bottom:1px solid var(--stroke)}

    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:24px;background:#fff;border:1px solid var(--stroke);padding:12px 16px;border-radius:12px;box-shadow:0 18px 40px rgba(15,23,42,.18);display:none;font-weight:700}
    .toast.show{display:block}

    .muted{color:var(--muted)}

    @media (max-width:1100px){
      .wrap.layout{grid-template-columns:1fr}
      .row{flex-wrap:wrap}
      .search{min-width:100%}
      .sidebar{position:static}
    }
    @media (max-width:720px){
      header.card.intro{padding:18px}
      .thead,.trow{grid-template-columns:32px 120px 1fr}
      .thead > :nth-child(n+4),.trow > :nth-child(n+4){display:none}
      .bulkbar{flex-wrap:wrap;gap:10px}
      .bulkbar > div:first-child{width:100%}
    }
  </style>
</head>
<body>
  <div class="top"><div class="row">
    <div class="brand">
      <a href="../"><span class="logo">H</span> HMJ Global</a>
      <span class="pill">Admin</span>
      <span class="pill">Candidates</span>
    </div>
    <div class="sp"></div>
    <a class="btn ghost small" href="/">← Website</a>
    <a class="btn ghost" href="./">⟵ Dashboard</a>
    <button class="btn light" onclick="window.netlifyIdentity?.logout()">Sign out</button>
  </div></div>

  <header class="card intro">
    <div>
      <p class="crumbs">Admin console</p>
      <h1>Candidates overview</h1>
      <p class="lead">Search, filter, and manage the HMJ Global talent pool. Use the filters to refine results and open a candidate for full details.</p>
    </div>
    <div class="debug">
      <span class="pill ok" id="dbg-identity">identity: ok</span>
      <span class="pill ok" id="dbg-token">token: ok</span>
      <span class="pill ok" id="dbg-role">role: admin</span>
      <span class="pill" id="dbg-sb">supabase: live</span>
      <span class="pill" id="dbg-version">build: -</span>
      <div id="debug-panel">
        <button id="debug-toggle" class="btn ghost small" type="button">Show debug</button>
        <div class="dbg-body">
          <div class="dbg-row"><strong>Identity</strong><span id="dbg-ident-value">-</span></div>
          <div class="dbg-row"><strong>Token</strong><span id="dbg-token-value">-</span></div>
          <div class="dbg-row"><strong>Supabase</strong><span id="dbg-sb-value">-</span></div>
          <div class="dbg-row"><strong>Last query</strong><span id="dbg-query">-</span></div>
          <div class="dbg-row"><strong>Logs</strong></div>
          <ul id="dbg-logs" class="dbg-logs"></ul>
          <button id="dbg-export" class="btn" type="button" style="margin-top:12px">Export logs</button>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap layout">
    <!-- Filters -->
    <aside class="card sidebar" id="filters">
      <div class="group">
        <h3>Search</h3>
        <input id="q" placeholder='name, email, ref… (supports AND/OR/NOT)' />
      </div>
      <div class="group">
        <h3>Status</h3>
        <select id="flt-status" multiple>
          <option>active</option><option>in progress</option><option>complete</option>
          <option>archived</option><option>blocked</option>
        </select>
      </div>
      <div class="group">
        <h3>Role &amp; region</h3>
        <input id="flt-role" placeholder="role title" />
        <input id="flt-region" placeholder="country / region / depot" />
      </div>
      <div class="group">
        <h3>Skills / tags</h3>
        <input id="flt-skills" placeholder="comma separated e.g. SAP, LV, MV" />
      </div>
      <div class="group">
        <h3>Availability</h3>
        <input id="flt-avail" type="date" />
      </div>
      <div class="group">
        <h3>Dates</h3>
        <input id="flt-created-from" type="date" />
        <input id="flt-created-to" type="date" />
      </div>
      <div class="group" style="display:flex;gap:8px">
        <button class="btn" id="btn-clear">Clear all</button>
        <button class="btn primary" id="btn-apply">Apply</button>
      </div>
      <div class="muted" id="flt-count">0 results</div>
    </aside>

    <!-- Main -->
    <main class="grid">
      <section class="card table-card">
        <div class="toolbar">
          <div class="search">
            <input id="search" placeholder="Quick search ( / to focus )" />
            <button class="btn" id="btn-refresh">Refresh</button>
          </div>
          <div class="totals">
            <span class="pill" id="t-total">Total: 0</span>
            <span class="pill" id="t-progress">In progress: 0</span>
            <span class="pill" id="t-archived">Archived: 0</span>
            <span class="pill" id="t-blocked">Blocked: 0</span>
          </div>
        </div>

        <div class="table">
          <div class="thead">
            <div><input type="checkbox" id="chk-all"/></div>
            <div>Ref</div><div>Name</div><div>Email</div><div>Status</div><div>Job Title</div><div>Actions</div>
          </div>
          <div class="vscroll" id="rows" aria-live="polite"></div>
          <div class="bulkbar" id="bulkbar">
            <div id="bulk-count">0 selected</div>
            <div style="display:flex;gap:8px">
              <button class="btn" id="bulk-assign">Assign recruiter</button>
              <button class="btn" id="bulk-status">Update status</button>
              <button class="btn red" id="bulk-block">Block</button>
              <button class="btn" id="bulk-archive">Archive</button>
              <button class="btn" id="bulk-export">Export CSV</button>
              <button class="btn ghost" id="bulk-clear">Clear</button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Drawer -->
  <aside class="drawer" id="drawer">
    <div class="head">
      <strong id="dw-name">Candidate</strong>
      <div style="display:flex;gap:8px">
        <button class="btn" id="dw-email">Email</button>
        <button class="btn" id="dw-call">Call</button>
        <button class="btn red" id="dw-block">Block</button>
        <button class="btn ghost" id="dw-close">Close</button>
      </div>
    </div>
    <div class="sec" id="dw-profile"></div>
    <div class="sec" id="dw-docs"></div>
    <div class="sec" id="dw-notes"></div>
    <div class="sec" id="dw-audit"></div>
  </aside>

  <button class="fab" id="fab-new">+ New candidate</button>
  <div class="toast" id="toast"></div>

  <script defer src="/admin/candidates.js"></script>
</body>
</html>
